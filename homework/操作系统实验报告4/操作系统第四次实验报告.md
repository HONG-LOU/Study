<font face="楷体">

## 操作系统 实验报告一

### 21级软件工程一班 宁智伟 202131603131

### 实验题目：首先考虑显示

### 实验时间：2023.11

### 实验内容：

#### 1.设置显示模式
  该功能用于设置当前的视频显示方式，包括显存的地址在哪里，是字符模式还是文本模式，屏幕分辨率是多少，能显示多少种颜色等。
  <img src="image.png" width="50%">

  创建新的虚拟机，按照要求进行设置后启动，出现如下画面

  <img src="image-2.png" width="50%">

  说明虚拟机软件安装成功。

#### 2.安装nasm
  由于操作系统是直接运行在裸机之上的系统软件，编写操作系统时必须要从计算机的底层硬件做起，因此汇编语言是绕不开的。如前所述，myos 将运行在 8086 CPU上，所以搭建 myos 的开发环境时还需要安装 8086 汇编器。
  
  本次安装nasm作为x86编译器

  从nasm官网下载完成后按提示完成安装，并将nasm环境添加至系统环境变量。在命令行进行测试，测试效果如下图，则说明安装并配置成功

  <img src="image-3.png" width="50%">

#### 3.安装minggw
  汇编语言用于编写 myos 的底层支持必不可少，但 myos 的整体框架及大部分代码得用C 语言来编写，因此开发环境还需要一个好用的 C 语言编译器。
  C 语言编译器当然首选 gcc，但 gcc 是 GNU 家族的类 UNIX 工具，在 Windows 下运行需要相应的支撑平台，比如 Cygwin 和 MinGw 等。

  在官网进行下载并安装，并将minggw-bin环境添加至系统环境变量，在命令行进行测试，测试效果如下图，则说明安装成功
  
  <img src="image-4.png" width="50%">

#### 4.安装Hex Editor Neo

  Hex Editor Neo 是一个免费的十六进制编辑器，它可以把任何文件都以每个字节用两位十六进制数显示的方式展现出来，通过 Hex Editor Neo 可以方便的了解各种文件的内部结构。

  在官网进行下载并按提示进行安装后，效果如下图

  <img src="image-5.png" width="50%">

### 实验目的

  本次实验从计算机系统的启动过程讲起，一步一步制作引导盘，并用引导盘启动计算机系统。内容包括计算机系统的启动过程介绍，开发环境的搭建以及引导盘的制作与启动。

### 实验环境

  在命令行对实验环境版本测试，结果如下图
  <img src="image-6.png" width="50%">

### 实验步骤

  #### 1.A.img
  
  软盘镜像的意思是用一个磁盘文件来模拟软盘，也就是说，我们可以把硬盘上的一个文件当做软盘来用。首先，这个文件的扩展名必须是 img，表示软盘镜像文件，由于镜像文件要被虚拟机访问，因此扩展名必须是 img 实际上是由虚拟机要求的。文件名则可以任意命名，这里命名为 A，表示是 A 软盘。

  <img src="image-7.png" width="50%">

  #### 2.编写MBR

  CPU 通过执行 BIOS 中的引导程序把MBR 读入到内存中，然后 CPU 通过执行 MBR 中的引导代码把操作系统读入到内存中，最后 CPU 执行内存中的操作系统，从而实现对计算机系统的管理。也就是说 MBR 是用来引导操作系统 myos 的。

  <img src="image-8.png" width="50%">
  
  #### 3.汇编MBR并写入A.img

  mbr.asm 不能被 CPU 执行，需要汇编成机器语言代码才能执行。在屏幕左下角点击开始按钮，在搜索栏输入 cmd，然后回车进入 DOS 提示符界面，然后进行汇编，结果如图所示

  <img src="image-9.png" width="50%">

  再在 Hex Editor Neo 编辑器中打开 A.img，把鼠标移到左上角第一个字节的位置，点击右键，选择粘贴，如图所示

  <img src="image-10.png" width="50%">

  #### 4.引导引导盘

  打开 VMware Player，选择 myos 虚拟机，然后右键-设置，或者点击右下角的“编辑虚拟机设置”。在出现的设置界面上选择软盘，选择“使用软盘镜像文件”，“浏览”找到正确的 A.img，

  <img src="image-11.png" width="50%">

  运行虚拟机，得到如下结果，说明实验成功。

  <img src="image-12.png" width="60%">

### 实验心得

  通过本次实验，我学习到了系统如何运行自己的操作系统，理解到了x86汇编语言的运行方式，了解到了文件的十六进制格式，以及相互之间如何转换，收益颇丰！